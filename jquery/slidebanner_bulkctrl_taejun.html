<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <style>

        *{margin:0; padding:0;}
        ul{list-style:none}
        .slide{width:500px; height:300px; border:1px #F00 solid; position:relative; margin:0 auto; overflow:hidden;}
        .slide button{position:absolute; top:50%; z-index:1;}
        .slide button.next{right:0px;}
        .slide button.prev{left:0px;}
        .slide ul{text-align:center;}
        .slide li{display:inline-block;}
        .slide li a{display:block; width: 20px; height:20px; position:relative; z-index: 1; border:1px #F00 solid;  color:#000; top:250px; text-decoration:none;}
        .slide li img{width:100%; height: 100%; position:absolute; left:0; top:0; display:none;}
        .slide li:first-child img{display:block;}
        .slide li.on a{background-color: #f00;}

    </style>

    <script type="text/javascript">

    $(function(){

    //     function movement(start,end,selector){

    //     $('.slide:eq('+selecteridx+') li').removeClass().eq(selector).addClass('on').children('img').css({

    //         'display' : 'block',
    //         'left' : start

    //     }).stop().animate({
    //         left : end
    //     })

    //     if(selector==$('.slide:eq('+selecteridx+') li').length){
    //         idxarr[selecteridx]=0;
    //         movement("100%","0",idxarr[selecteridx])

    //     }else if(selector<0){
    //         idxarr[selecteridx]=$('.slide:eq('+selecteridx+') li').length-1
    //         movement("-100%","0",idxarr[selecteridx])
    //     }


    // }

    function movement(start,end,selector,target){
        $('body .slide').eq(target).find('li').removeClass('on').eq(selector)
            .addClass('on').children('img').css({
            'display' : 'block',
            'left' : start

            }).stop().animate({
                left : end
            })

            if(idxarr[selecteridx] == $('.slide:eq('+selecteridx+') li').length){
              idxarr[selecteridx] = 0;

              movement("100%","0",idxarr[selecteridx],selecteridx)
            }else if(idxarr[selecteridx] < 0){

                idxarr[selecteridx]=$('.slide:eq('+selecteridx+') li').length-1
                movement("-100%","0",idxarr[selecteridx],selecteridx)

            }




    }

        var idxarr = [];
        $('body .slide').each(function(i,e){
            idxarr.push(0);
            console.log(idxarr)

        })

        var selecteridx;

        $('.slide .next').click(function(){
        selecteridx = $(this).parent().index();
    
        movement("0","-100%",idxarr[selecteridx],selecteridx)

        idxarr[selecteridx]++

        console.log(idxarr[selecteridx])

        movement("100%","0",idxarr[selecteridx],selecteridx)

        // console.log(idxarr)

        })

        $('.slide .prev').click(function(){
        selecteridx = $(this).parent().index();
        
        movement("0","100%",idxarr[selecteridx],selecteridx)

        idxarr[selecteridx]--

        console.log(idxarr[selecteridx])

        movement("-100%","0",idxarr[selecteridx],selecteridx)

        // console.log(idxarr)
        })



       
        
        $('.slide li a').click(function(){
        selecteridx = $(this).parents('.slide').index();
       
      
        idxarr[selecteridx] = $(this).parent().index();
        
        
        var his = $('.slide:eq('+selecteridx+') li.on').index()
      
      
        
        
        if(his<idxarr[selecteridx]){
        
        movement("0","-100%",his,selecteridx)
        movement("100%","0",idxarr[selecteridx],selecteridx)
        
            
        }else if(his>idxarr[selecteridx]){
        
        movement("0","100%",his,selecteridx)
        movement("-100%","0",idxarr[selecteridx],selecteridx)
        
            
        }


        return false

        })



    })



    </script>

</head>
<body>

    <div class="slide">

        <button class="next">다음</button>
        <button class="prev">이전</button>

        <div>
            <ul>
                <li class="on">
                    <a href="">1</a>
                    <img src="img/sky1.jpg">
                </li>
                <li>
                    <a href="">2</a>
                    <img src="img/sky2.jpg">
                </li>
                <li>
                    <a href="">3</a>
                    <img src="img/sky3.jpg">
                </li>
                <li>
                    <a href="">4</a>
                    <img src="img/sky4.jpg">
                </li>

            </ul>
        </div>

    </div>

    <div class="slide">

        <button class="next">다음</button>
        <button class="prev">이전</button>

        <div>
            <ul>
                <li class="on">
                    <a href="">1</a>
                    <img src="img/sky1.jpg">
                </li>
                <li>
                    <a href="">2</a>
                    <img src="img/sky2.jpg">
                </li>
                <li>
                    <a href="">3</a>
                    <img src="img/sky3.jpg">
                </li>


            </ul>
        </div>

    </div>

    <div class="slide">

        <button class="next">다음</button>
        <button class="prev">이전</button>

        <div>
            <ul>
                <li class="on">
                    <a href="">1</a>
                    <img src="img/sky1.jpg">
                </li>
                <li>
                    <a href="">2</a>
                    <img src="img/sky2.jpg">
                </li>
                <li>
                    <a href="">3</a>
                    <img src="img/sky3.jpg">
                </li>
                <li>
                    <a href="">4</a>
                    <img src="img/sky4.jpg">
                </li>

            </ul>
        </div>

    </div>

    <div class="slide">

        <button class="next">다음</button>
        <button class="prev">이전</button>

        <div>
            <ul>
                <li>
                    <a href="">1</a>
                    <img src="img/sky1.jpg">
                </li>
                <li class="on">
                    <a href="">2</a>
                    <img src="img/sky2.jpg">
                </li>
                <li>
                    <a href="">3</a>
                    <img src="img/sky3.jpg">
                </li>
                <li>
                    <a href="">4</a>
                    <img src="img/sky4.jpg">
                </li>
                <li>
                    <a href="">6</a>
                    <img src="img/sky4.jpg">
                </li>
                <li>
                    <a href="">7</a>
                    <img src="img/sky4.jpg">
                </li>
                <li>
                    <a href="">8</a>
                    <img src="img/sky4.jpg">
                </li>

            </ul>
        </div>

    </div>


</body>
</html>
